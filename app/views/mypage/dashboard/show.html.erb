<div class="container mx-auto px-4 my-8" data-controller="step-guide">
  <!-- Hero -->
  <div class="hero shadow-lg mb-8">
    <div class="hero-content flex-col lg:flex-row">
        <%= image_tag "icon.svg", alt: "icon", class: "w-85 h-auto"%>
      <div>
        <h1 class="text-4xl font-bold mb-4">ようこそ、<br><%= current_user.name %>さん！</h1>
        <p>本日も練習で学んだことを記録しましょう。</p>
        <p>本アプリの使い方については、以下のステップガイドをご参照ください。</p>
        <div class="flex justify-center">
        <button data-action="click->step-guide#startMenuGuide" class="btn btn-primary btn-wide btn-lg my-10">ステップガイドを始める</button>
        </div>
      </div>
    </div>
  </div>

  <!-- i18n対応(要:ERB記載)＋ハイライトエレメントなしのステップ作成(要JS記載)を両立させるため、ERBに記載した内容を step_guide_controller.js に渡す -->

  <!-- Technique & Flow Chart 横並び -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <!-- Technique -->
    <%= link_to mypage_techniques_path,
        id: "step1",
        data: { title_text: "STEP 1",
                intro_text: "このメニューから、テクニック一覧を確認することができます。<br>練習中に気がついたことをテクニックごとに記録しておきましょう。" },
        class: "card bg-base-100 hover:shadow-xl transition-shadow rounded-2xl" do %>
      <div class="card-body">
        <div class="flex items-start justify-between gap-4">
          <!-- 左：アイコン + タイトル/説明 -->
          <div class="flex items-center gap-3">
            <!-- アイコン -->
            <div class="size-11 rounded-xl bg-base-200 grid place-items-center group-hover:scale-105 transition">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                   fill="currentColor" class="size-6 opacity-80">
                <path fill-rule="evenodd"
                      d="M2.625 6.75a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875 0A.75.75 0 0 1 8.25 6h12a.75.75 0 0 1 0 1.5h-12a.75.75 0 0 1-.75-.75ZM2.625 12a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0ZM7.5 12a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 0 1.5h-12A.75.75 0 0 1 7.5 12Zm-4.875 5.25a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875 0a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 0 1.5h-12a.75.75 0 0 1-.75-.75Z"
                      clip-rule="evenodd" />
              </svg>
            </div>
            <div>
              <h3 class="font-semibold text-lg">Technique</h3>
              <p class="text-sm opacity-70">技の一覧と練習メモを管理します。</p>
            </div>
          </div>
  
          <!-- 右：メトリクス / 矢印 -->
          <div class="flex items-center gap-2">
            <!-- sm以下だとバッジ内で文字列が折り返してしまうので非表示 -->
            <span class="sm:inline hidden badge badge-outline"><%= @technique_count %> テクニック</span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                 fill="none" class="size-5 opacity-60 group-hover:opacity-100 transition">
              <path d="M9 5l7 7-7 7" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Flow Chart -->
    <%= link_to mypage_chart_path(@chart.id),
        id: "step2",
        data: { title_text: "STEP 2",
                intro_text: "このメニューから、テクニックの展開を流れ図で可視化することができます。<br>試合の流れを整理するのに役立ちます。" },
        class: "card bg-base-100 hover:shadow-xl transition-shadow rounded-2xl" do %>
      <div class="card-body">
        <div class="flex items-start justify-between gap-4">
          <div class="flex items-center gap-3">
            <div class="size-11 rounded-xl bg-base-200 grid place-items-center group-hover:scale-105 transition">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                   fill="currentColor" class="size-6 opacity-80">
                <circle cx="6" cy="12" r="2.5" />
                <circle cx="14" cy="6" r="2.5" />
                <circle cx="18" cy="12" r="2.5" />
                <circle cx="14" cy="18" r="2.5" />
                <line x1="6" y1="12" x2="14" y2="6" stroke="currentColor" stroke-width="1.5" />
                <line x1="6" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="1.5" />
                <line x1="6" y1="12" x2="14" y2="18" stroke="currentColor" stroke-width="1.5" />
              </svg>
            </div>

            <div>
              <h3 class="font-semibold text-lg">Flow Chart</h3>
              <p class="text-sm opacity-70">試合の流れを可視化します。</p>
            </div>
          </div>

          <div class="flex items-center gap-2">
            <span class="sm:inline hidden badge badge-outline"><%= @node_count %> ノード</span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                 fill="none" class="size-5 opacity-60 group-hover:opacity-100 transition">
              <path d="M9 5l7 7-7 7" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- 更新情報 -->
  <div class="card bg-base-200 shadow rounded-2xl">
    <div class="card-body p-4">
      <h3 class="text-base font-semibold mb-2">更新情報</h3>
      <div class="h-80 overflow-y-auto pr-1 overscroll-contain">
        <%= render "changelog" %>
      </div>
    </div>
  </div>

  <!-- step-guide用の非表示要素 -->
  <div id="step0" data-title-text="ようこそ！" data-intro-text="このガイドでは、画面に表示されている各メニューについて説明します。" class="hidden"></div>
  <div
    id="step4"
    data-intro-text="メニューの説明は以上です。<br><br>まず何をすればよいか分からない方は <a class='underline font-bold' href=<%= mypage_techniques_path %>>Technique</a> メニューを開き、左上にある
      <svg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor' class='size-6 inline'>
        <path stroke-linecap='round' stroke-linejoin='round' d='M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z' />
      </svg>
      をクリックしてみましょう！" class="hidden">
  </div>
</div>
