<% content_for(:title, t(".title")) %>
<div class="container mx-auto px-4 my-8"
  data-controller="step-guide"
  data-step-guide-scope-value="guides.dashboard"
  data-step-guide-techniques-path-value="<%= mypage_techniques_path %>"
  data-step-guide-charts-path-value="<%= mypage_charts_path %>"
>
  <!-- Hero -->
  <div class="hero shadow-lg mb-8">
    <div class="hero-content flex-col lg:flex-row">
        <%= image_tag "icon.svg", alt: "icon", class: "w-85 h-auto"%>
      <div>
        <h1 class="text-4xl font-bold mb-4"><%= t(".welcome") %><br><%= t(".username", name: current_user.name) %></h1>
        <p><%= t(".take_note") %></p>
        <p><%= t(".check_howtouse") %></p>
        <div class="flex justify-center">
          <button data-action="click->step-guide#startDashboardGuide" class="btn btn-primary btn-wide btn-lg my-10"><%= t(".start_guide") %></button>
        </div>
      </div>
    </div>
  </div>

  <!-- i18n対応(要:ERB記載)＋ハイライトエレメントなしのステップ作成(要JS記載)を両立させるため、ERBに記載した内容を step_guide_controller.js に渡す -->

  <!-- Technique & Flow Chart 横並び -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <!-- Technique -->
    <%= link_to mypage_techniques_path,
        id: "guide-technique",
        class: "card bg-base-100 hover:shadow-xl transition-shadow rounded-2xl" do %>
      <div class="card-body">
        <div class="flex items-start justify-between gap-4">
          <!-- 左：アイコン + タイトル/説明 -->
          <div class="flex items-center gap-3">
            <!-- アイコン -->
            <div class="size-11 rounded-xl bg-base-200 grid place-items-center group-hover:scale-105 transition">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                   fill="currentColor" class="size-6 opacity-80">
                <path fill-rule="evenodd"
                      d="M2.625 6.75a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875 0A.75.75 0 0 1 8.25 6h12a.75.75 0 0 1 0 1.5h-12a.75.75 0 0 1-.75-.75ZM2.625 12a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0ZM7.5 12a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 0 1.5h-12A.75.75 0 0 1 7.5 12Zm-4.875 5.25a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875 0a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 0 1.5h-12a.75.75 0 0 1-.75-.75Z"
                      clip-rule="evenodd" />
              </svg>
            </div>
            <div>
              <h3 class="font-semibold text-lg"><%= t("header.technique") %></h3>
              <p class="text-sm opacity-70"><%= t(".technique_details") %></p>
            </div>
          </div>
  
          <!-- 右：メトリクス / 矢印 -->
          <div class="flex items-center gap-2">
            <!-- lg以下だとバッジ内で文字列が折り返してしまうので非表示 -->
            <span class="lg:inline hidden badge badge-outline"><%= t(".metrics.techniques", count: @techniques_count, n: number_with_delimiter(@techniques_count)) %></span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                 fill="none" class="size-5 opacity-60 group-hover:opacity-100 transition">
              <path d="M9 5l7 7-7 7" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Flow Chart -->
    <%= link_to mypage_charts_path,
        id: "guide-chart",
        class: "card bg-base-100 hover:shadow-xl transition-shadow rounded-2xl" do %>
      <div class="card-body">
        <div class="flex items-start justify-between gap-4">
          <div class="flex items-center gap-3">
            <div class="size-11 rounded-xl bg-base-200 grid place-items-center group-hover:scale-105 transition">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                   fill="currentColor" class="size-6 opacity-80">
                <circle cx="6" cy="12" r="2.5" />
                <circle cx="14" cy="6" r="2.5" />
                <circle cx="18" cy="12" r="2.5" />
                <circle cx="14" cy="18" r="2.5" />
                <line x1="6" y1="12" x2="14" y2="6" stroke="currentColor" stroke-width="1.5" />
                <line x1="6" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="1.5" />
                <line x1="6" y1="12" x2="14" y2="18" stroke="currentColor" stroke-width="1.5" />
              </svg>
            </div>

            <div>
              <h3 class="font-semibold text-lg"><%= t("header.flow_chart") %></h3>
              <p class="text-sm opacity-70"><%= t(".chart_details") %></p>
            </div>
          </div>

          <div class="flex items-center gap-2">
            <span class="lg:inline hidden badge badge-outline"><%= t(".metrics.charts", count: @charts_count, n: number_with_delimiter(@charts_count)) %></span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                 fill="none" class="size-5 opacity-60 group-hover:opacity-100 transition">
              <path d="M9 5l7 7-7 7" stroke="currentColor" stroke-width="1.8"
                    stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- 更新情報 -->
  <div class="card bg-base-200 shadow rounded-2xl">
    <div class="card-body p-4">
      <h3 class="text-base font-semibold mb-2"><%= t(".updates") %></h3>
      <div class="h-80 overflow-y-auto pr-1 overscroll-contain">
        <%= render "changelog" %>
      </div>
    </div>
  </div>
</div>
